## Understand Retrieval Augmented Generation (RAG) with Azure OpenAI Service
* RAG with Azure OpenAI allows developers to use supported AI chat models that can reference specific sources of information to ground the response. 
* Adding this information allows the model to reference both the specific data provided and its pretrained knowledge to provide more effective responses.
* Azure OpenAI enables RAG by connecting pretrained models to your own data sources. 
* Azure OpenAI on your data utilizes the search ability of Azure AI Search to add the relevant data chunks to the prompt. 
* Once your data is in a AI Search index, Azure OpenAI on your data goes through the following steps:
    1. Receive user prompt.
    1. Determine relevant content and intent of the prompt.
    1. Query the search index with that content and intent.
    1. Insert search result chunk into the Azure OpenAI prompt, along with system message and user prompt.
    1. Send entire prompt to Azure OpenAI.
    1. Return response and data reference (if any) to the user.
* Fine-tuning vs. RAG
    1. Fine-tuning is a technique used to create a custom model by training an existing foundational model such as gpt-35-turbo with a dataset of additional training data. 
        1. Fine-tuning can result in higher quality requests than prompt engineering alone, 
        1. customize the model on examples larger than can fit in a prompt, 
        1. and allow the user to provide fewer examples to get the same high quality response. 
        1. However, the process for fine-tuning is both costly and time intensive, and should only be used for use cases where it's necessary.
    1. RAG with Azure OpenAI on your data still uses the stateless API to connect to the model, which removes the requirement of training a custom model with your data and simplifies the interaction with the AI model. 
        1. AI Search first finds the useful information to answer the prompt, adds that to the prompt as grounding data, and Azure OpenAI forms the response based on that information.

## Add your own data source
* Adding your data is done through the Azure AI Studio, in the Chat playground, or by specifying your data source in an API call. 
* The data source you add is then used to augment the prompt sent to the model. 
* When setting up your data in the studio, you can choose to upload your data files, use data in a blob storage account, or connect to an existing AI Search index.
    1. Azure OpenAI on your data supports .md, .txt, .html, .pdf, and MS Word or PowerPoint files. 
    1. Graphics or images files, the response quality depends on how well text can be extracted from the visual content.
* It's recommended to use the Azure AI Studio to create the search resource and index. 
    1. Adding data this way allows the appropriate chunking to happen when inserting into the index, yielding better responses. 
* If you're using large text files or forms, you should use the available <a href="https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/use-your-data?tabs=ai-search%2Ccopilot#ingesting-your-data-into-azure-cognitive-search?azure-portal=true">data preparation script to improve the AI model's accuracy</a>.
* Enabling <a href="https://learn.microsoft.com/en-us/azure/search/semantic-search-overview">semantic search</a> for your AI Search service can improve the result of searching your data index and you're likely to receive higher quality responses and citations. However, enabling semantic search may increase the cost of the search service.
* Use the wizard in your AI Search resource to vectorize your data appropriately. It takes a few extra steps compared to doing so in AI Studio, however serves as a good example of using the RAG pattern with an existing dataset.
* Connect your data -> Chat playground -> Add your data tab -> Add a data source button -> setting up the connection to each data source, and getting that data into a search index.
    1. Using the wizard in AI Studio to create and connect your data source, need to create a hub and a project. 
    1. AI Studio will walk you through doing that, or refer to the <a href="https://learn.microsoft.com/en-us/azure/ai-studio/concepts/ai-resources">AI Studio documentation</a>.
    1. If you're using your own index that wasn't created through Azure AI Studio, one of the pages allows you to specify your column mapping. 
        1. It's important to provide accurate fields, to enable the model to provide a better response, especially for Content data.
* <imge src="https://learn.microsoft.com/en-us/training/wwl-data-ai/use-own-data-azure-openai/media/index-data-mapping.png" width=500 height=500>
